# Hackathon Case 3 — Сервис аналитики поведения и обращений пользователей (NDA, без данных)
Ссылка на презентацию : https://docs.google.com/presentation/d/17UGZYj5GpMHbIJUg2emHNUj4x5RyRM4J/edit?slide=id.p2#slide=id.p2
Ноутбук_nlp: https://colab.research.google.com/drive/1S68ffcm6VlMlo2BIl7mcvhXYDE__QCvv?usp=sharing
Папка с моделями: https://drive.google.com/drive/folders/17JbOwP2g7E-ZZSWn388QgEizjGxrc2Er?usp=sharing
Этот репозиторий содержит сервис для:
- анализа поведения пользователей в мобильном приложении ЖКХ;
- прогнозирования оттока;
- NLP-аналитики текстовых обращений.

Сервис поднимается в Docker и предоставляет веб-интерфейс:
- раздел `/` — аналитика поведения и оттока;
- раздел `/nlp` — аналитика обращений (NLP).

**Важное замечание (NDA):**
- В репозитории **нет и не будет** исходных данных (выгрузок событий, socdem, обращений).
- Все файлы с данными загружаются пользователем локально через веб-интерфейс.
- В `.gitignore` намеренно заблокированы форматы данных (`.xlsx`, `.csv`, `.json`, `.parquet` и т.д.).

---

## Функциональность

### 1. Аналитика поведения и оттока (`/`)

Сервис ожидает от пользователя два файла (загружаются через форму):
- таблица событий (логи приложения);
- socdem-информация по пользователям.

Основные шаги пайплайна:
- предобработка событий (приведение дат, типов событий, устройств и т.п.);
- построение признаков на уровне пользователя и сессии;
- обучение и сравнение нескольких моделей прогноза оттока:
  - Logistic Regression;
  - Random Forest;
  - LightGBM (основная модель);
- расчёт метрик (ROC-AUC, F1, confusion matrix);
- построение интерактивных графиков (Plotly), включая:
  - распределение оттока (0/1);
  - активность по часам суток;
  - активность по часам с разбивкой по полу/ОС;
  - распределение возрастов по полу;
  - длина сессий по возрастным группам и ОС;
  - активность по производителям устройств и моделям;
  - тепловая карта функциональной активности;
  - корреляционная матрица признаков.

Графики сохраняются как HTML в `static/plots/` и в git **не попадают**.

### 2. NLP-аналитика обращений (`/nlp`)

Сервис принимает таблицу с текстами обращений и применяет две лёгкие модели:

1. **Оценка уровня негатива**
   - Классы:
     - 0 — нейтральное сообщение;
     - 1 — эмоциональное, но без явной агрессии;
     - 2 — выраженная агрессия.
   - Метрика на валидации: F1 macro ≈ 0.55–0.60 (несбалансированный датасет).

2. **Классификация типа обращения**
   - Классы:
     - 0 — запрос что-то сделать / нейтральное сообщение;
     - 1 — пользователь что-то не понял / не нашёл в приложении;
     - 3 — сообщение о проблеме.
   - Метрики: F1 macro ≈ 0.84 (валидация), ≈ 0.75 (тест).

На дашборде отображается:
- распределение обращений по уровням негатива;
- распределение по типам;
- тепловая карта по комбинации «негатив × тип».

---

## Технологический стек

- **Backend:** FastAPI, Uvicorn
- **ML / данные:** pandas, numpy, scikit-learn, lightgbm,transformers, pytorch
- **Визуализация:** Plotly (интерактивные HTML-графики)
- **NLP:** ML-классификаторы на основе ruBERT, описаны в ноутбуках
- **Контейнеризация:** Docker, docker-compose

---

## Запуск через Docker

Требования:
- Docker
- docker-compose

Шаги:

```bash
git clone https://github.com/flazy2222/hackathon_case3.git
cd hackathon_case3

docker-compose up --build


